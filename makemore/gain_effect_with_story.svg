<svg viewBox="0 0 1400 1100" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="700" y="30" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">
    Effect of Gain on Gradient Flow: The Story of Learning
  </text>

  <!-- Three scenarios -->

  <!-- Scenario 1: gain = 0.5 (too small) -->
  <g id="gain_small">
    <rect x="20" y="60" width="440" height="950" fill="#FFEBEE" stroke="#C62828" stroke-width="3" rx="10"/>
    <text x="240" y="95" font-size="18" font-weight="bold" text-anchor="middle" fill="#C62828">
      gain = 0.5 (TOO SMALL)
    </text>
    <text x="240" y="118" font-size="13" text-anchor="middle" fill="#D32F2F">
      "The Fading Signal" ğŸ“‰
    </text>

    <!-- Histograms -->
    <text x="50" y="155" font-size="12" font-weight="bold" fill="#333">Layer 3 (deep):</text>
    <path d="M 240 180 Q 240 165, 250 165 L 230 165 Q 240 165, 240 180 Z"
          fill="#FFCDD2" stroke="#C62828" stroke-width="1"/>
    <text x="350" y="172" font-size="10" fill="#C62828">grad â‰ˆ 0.001 (barely visible!)</text>

    <text x="50" y="225" font-size="12" font-weight="bold" fill="#333">Layer 2:</text>
    <path d="M 240 250 Q 220 230, 260 230 Q 240 230, 240 250 Z"
          fill="#FFCDD2" stroke="#C62828" stroke-width="1"/>
    <text x="350" y="242" font-size="10" fill="#C62828">grad â‰ˆ 0.01 (very flat)</text>

    <text x="50" y="295" font-size="12" font-weight="bold" fill="#333">Layer 1:</text>
    <path d="M 240 320 Q 210 285, 270 285 Q 240 285, 240 320 Z"
          fill="#FFCDD2" stroke="#C62828" stroke-width="1"/>
    <text x="350" y="307" font-size="10" fill="#EF6C00">grad â‰ˆ 0.1 (flattening)</text>

    <text x="50" y="365" font-size="12" font-weight="bold" fill="#333">Layer 0 (shallow):</text>
    <path d="M 240 390 Q 190 340, 290 340 Q 240 340, 240 390 Z"
          fill="#FFCDD2" stroke="#C62828" stroke-width="2"/>
    <text x="350" y="372" font-size="10" fill="#2E7D32">grad â‰ˆ 0.5 (only decent one)</text>

    <!-- Story -->
    <rect x="40" y="430" width="400" height="560" fill="white" stroke="#C62828" stroke-width="2" rx="5"/>
    <text x="240" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="#C62828">
      ğŸ“– The Story:
    </text>

    <text x="50" y="490" font-size="11" font-weight="bold" fill="#333">What "signal" means:</text>
    <text x="60" y="510" font-size="10" fill="#333">Signal = the gradient that tells a layer</text>
    <text x="60" y="525" font-size="10" fill="#333">"how much to update your weights"</text>

    <text x="50" y="555" font-size="11" font-weight="bold" fill="#333">What "learning" means:</text>
    <text x="60" y="575" font-size="10" fill="#333">Learning = updating weights based on</text>
    <text x="60" y="590" font-size="10" fill="#333">the gradient: new_W = old_W - lr * grad</text>

    <rect x="50" y="610" width="380" height="140" fill="#FFEBEE" rx="3"/>
    <text x="240" y="635" font-size="11" font-weight="bold" text-anchor="middle" fill="#C62828">
      ğŸ­ The Drama:
    </text>
    <text x="60" y="660" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 3:</tspan> "I got a gradient of 0.001? That's
    </text>
    <text x="60" y="675" font-size="10" fill="#333">
      nothing! I can barely update my weights!"
    </text>
    <text x="60" y="695" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 2:</tspan> "Mine is 0.01... still too weak."
    </text>
    <text x="60" y="715" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 1:</tspan> "0.1 is better but not great."
    </text>
    <text x="60" y="735" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 0:</tspan> "I got 0.5! I'm learning fast!"
    </text>

    <rect x="50" y="760" width="380" height="110" fill="#FFF9C4" rx="3"/>
    <text x="240" y="785" font-size="11" font-weight="bold" text-anchor="middle" fill="#F57C00">
      âš ï¸ The Problem:
    </text>
    <text x="60" y="810" font-size="10" fill="#333">
      â€¢ Deep layers learn 500x slower than
    </text>
    <text x="60" y="825" font-size="10" fill="#333">
         shallow layers (0.001 vs 0.5)
    </text>
    <text x="60" y="845" font-size="10" fill="#333">
      â€¢ Training is "incoherent" - layers at
    </text>
    <text x="60" y="860" font-size="10" fill="#333">
         wildly different speeds
    </text>

    <rect x="50" y="880" width="380" height="100" fill="#E1F5FE" rx="3"/>
    <text x="240" y="905" font-size="11" font-weight="bold" text-anchor="middle" fill="#0277BD">
      ğŸ” What You See in Histogram:
    </text>
    <text x="60" y="930" font-size="10" fill="#333">
      Each layer's curve at a different height
    </text>
    <text x="60" y="945" font-size="10" fill="#333">
      (y-axis scale) - they're "far apart" and
    </text>
    <text x="60" y="960" font-size="10" fill="#333">
      getting progressively flatter (wider/lower)
    </text>
  </g>

  <!-- Scenario 2: gain = 5/3 (perfect) -->
  <g id="gain_perfect">
    <rect x="480" y="60" width="440" height="950" fill="#E8F5E9" stroke="#2E7D32" stroke-width="4" rx="10"/>
    <text x="700" y="95" font-size="18" font-weight="bold" text-anchor="middle" fill="#2E7D32">
      gain = 5/3 (PERFECT!) â­
    </text>
    <text x="700" y="118" font-size="13" text-anchor="middle" fill="#388E3C">
      "The Balanced Symphony" ğŸµ
    </text>

    <!-- Histograms - all similar -->
    <text x="510" y="155" font-size="12" font-weight="bold" fill="#333">Layer 3 (deep):</text>
    <path d="M 700 180 Q 660 140, 740 140 Q 700 140, 700 180 Z"
          fill="#C8E6C9" stroke="#2E7D32" stroke-width="2"/>
    <text x="810" y="167" font-size="10" fill="#2E7D32">grad â‰ˆ 0.8</text>

    <text x="510" y="225" font-size="12" font-weight="bold" fill="#333">Layer 2:</text>
    <path d="M 700 250 Q 660 210, 740 210 Q 700 210, 700 250 Z"
          fill="#C8E6C9" stroke="#2E7D32" stroke-width="2"/>
    <text x="810" y="237" font-size="10" fill="#2E7D32">grad â‰ˆ 0.8</text>

    <text x="510" y="295" font-size="12" font-weight="bold" fill="#333">Layer 1:</text>
    <path d="M 700 320 Q 660 280, 740 280 Q 700 280, 700 320 Z"
          fill="#C8E6C9" stroke="#2E7D32" stroke-width="2"/>
    <text x="810" y="307" font-size="10" fill="#2E7D32">grad â‰ˆ 0.8</text>

    <text x="510" y="365" font-size="12" font-weight="bold" fill="#333">Layer 0 (shallow):</text>
    <path d="M 700 390 Q 660 350, 740 350 Q 700 350, 700 390 Z"
          fill="#C8E6C9" stroke="#2E7D32" stroke-width="2"/>
    <text x="810" y="377" font-size="10" fill="#2E7D32">grad â‰ˆ 0.8</text>

    <!-- Story -->
    <rect x="500" y="430" width="400" height="560" fill="white" stroke="#2E7D32" stroke-width="2" rx="5"/>
    <text x="700" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="#2E7D32">
      ğŸ“– The Story:
    </text>

    <text x="510" y="490" font-size="11" font-weight="bold" fill="#333">What "signal" means:</text>
    <text x="520" y="510" font-size="10" fill="#333">Signal = gradient magnitude</text>
    <text x="520" y="525" font-size="10" fill="#333">Stronger signal â†’ bigger weight updates</text>

    <text x="510" y="555" font-size="11" font-weight="bold" fill="#333">What "learning" means:</text>
    <text x="520" y="575" font-size="10" fill="#333">When grad = 0.8 â†’ weights change by</text>
    <text x="520" y="590" font-size="10" fill="#333">0.001 * 0.8 = 0.0008 (if lr = 0.001)</text>

    <rect x="510" y="610" width="380" height="140" fill="#E8F5E9" rx="3"/>
    <text x="700" y="635" font-size="11" font-weight="bold" text-anchor="middle" fill="#2E7D32">
      ğŸ­ The Drama:
    </text>
    <text x="520" y="660" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 3:</tspan> "Gradient of 0.8 - I can learn!"
    </text>
    <text x="520" y="680" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 2:</tspan> "Mine is 0.8 too - perfect!"
    </text>
    <text x="520" y="700" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 1:</tspan> "0.8 here as well - nice!"
    </text>
    <text x="520" y="720" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 0:</tspan> "Also 0.8 - we're all learning
    </text>
    <text x="520" y="735" font-size="10" fill="#333">
      at the same rate!"
    </text>

    <rect x="510" y="760" width="380" height="110" fill="#FFF9C4" rx="3"/>
    <text x="700" y="785" font-size="11" font-weight="bold" text-anchor="middle" fill="#F57C00">
      âœ¨ The Magic:
    </text>
    <text x="520" y="810" font-size="10" fill="#333">
      â€¢ All layers update weights by similar
    </text>
    <text x="520" y="825" font-size="10" fill="#333">
         amounts (all get ~0.8 gradient)
    </text>
    <text x="520" y="845" font-size="10" fill="#333">
      â€¢ Network learns as a coherent whole
    </text>
    <text x="520" y="860" font-size="10" fill="#333">
      â€¢ Training is stable and efficient
    </text>

    <rect x="510" y="880" width="380" height="100" fill="#E1F5FE" rx="3"/>
    <text x="700" y="905" font-size="11" font-weight="bold" text-anchor="middle" fill="#0277BD">
      ğŸ” What You See in Histogram:
    </text>
    <text x="520" y="930" font-size="10" fill="#333">
      All curves overlap beautifully - same
    </text>
    <text x="520" y="945" font-size="10" fill="#333">
      height, same width, all centered at 0.
    </text>
    <text x="520" y="960" font-size="10" fill="#333">
      Like a well-tuned orchestra! ğŸ»
    </text>
  </g>

  <!-- Scenario 3: gain = 3 (too large) -->
  <g id="gain_large">
    <rect x="940" y="60" width="440" height="950" fill="#FFF3E0" stroke="#E65100" stroke-width="3" rx="10"/>
    <text x="1160" y="95" font-size="18" font-weight="bold" text-anchor="middle" fill="#E65100">
      gain = 3.0 (TOO LARGE)
    </text>
    <text x="1160" y="118" font-size="13" text-anchor="middle" fill="#F57C00">
      "The Chaos" ğŸ’¥
    </text>

    <!-- Histograms - asymmetric -->
    <text x="970" y="155" font-size="12" font-weight="bold" fill="#333">Layer 3 (deep):</text>
    <line x1="1160" y1="165" x2="1160" y2="185" stroke="#E65100" stroke-width="4"/>
    <text x="1270" y="177" font-size="10" fill="#C62828">grad â‰ˆ 0 (DEAD spike!)</text>

    <text x="970" y="225" font-size="12" font-weight="bold" fill="#333">Layer 2:</text>
    <line x1="1160" y1="235" x2="1160" y2="255" stroke="#E65100" stroke-width="4"/>
    <text x="1270" y="247" font-size="10" fill="#C62828">grad â‰ˆ 0 (DEAD spike!)</text>

    <text x="970" y="295" font-size="12" font-weight="bold" fill="#333">Layer 1:</text>
    <path d="M 1160 320 Q 1100 285, 1220 285 Q 1160 285, 1160 320 Z"
          fill="#FFE0B2" stroke="#E65100" stroke-width="1"/>
    <text x="1270" y="307" font-size="10" fill="#EF6C00">grad â‰ˆ 2.5 (wide)</text>

    <text x="970" y="365" font-size="12" font-weight="bold" fill="#333">Layer 0 (shallow):</text>
    <path d="M 1160 390 Q 1050 340, 1270 340 Q 1160 340, 1160 390 Z"
          fill="#FFE0B2" stroke="#E65100" stroke-width="1"/>
    <text x="1270" y="372" font-size="10" fill="#C62828">grad â‰ˆ 10 (EXPLODING!)</text>

    <!-- Story -->
    <rect x="960" y="430" width="400" height="560" fill="white" stroke="#E65100" stroke-width="2" rx="5"/>
    <text x="1160" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="#E65100">
      ğŸ“– The Story:
    </text>

    <text x="970" y="490" font-size="11" font-weight="bold" fill="#333">What happened:</text>
    <text x="980" y="510" font-size="10" fill="#333">Weights were too large â†’ activations</text>
    <text x="980" y="525" font-size="10" fill="#333">hit tanh extremes (Â±1) â†’ saturated!</text>

    <text x="970" y="555" font-size="11" font-weight="bold" fill="#333">Saturated = dead gradient:</text>
    <text x="980" y="575" font-size="10" fill="#333">When tanh output â‰ˆ Â±1, derivative â‰ˆ 0</text>
    <text x="980" y="590" font-size="10" fill="#333">â†’ gradient can't flow backward</text>

    <rect x="970" y="610" width="380" height="140" fill="#FFF3E0" rx="3"/>
    <text x="1160" y="635" font-size="11" font-weight="bold" text-anchor="middle" fill="#E65100">
      ğŸ­ The Drama:
    </text>
    <text x="980" y="660" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 3:</tspan> "I'm stuck at Â±1! Gradient is
    </text>
    <text x="980" y="675" font-size="10" fill="#333">
      zero! I'm DEAD! Can't learn anything!"
    </text>
    <text x="980" y="695" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 2:</tspan> "Same here - totally frozen!"
    </text>
    <text x="980" y="715" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 1:</tspan> "My gradient is 2.5 - too big!"
    </text>
    <text x="980" y="735" font-size="10" fill="#333">
      <tspan font-weight="bold">Layer 0:</tspan> "Mine is 10! I'm changing way
    </text>
    <text x="980" y="750" font-size="10" fill="#333">
      too fast - this is chaos!"
    </text>

    <rect x="970" y="760" width="380" height="110" fill="#FFF9C4" rx="3"/>
    <text x="1160" y="785" font-size="11" font-weight="bold" text-anchor="middle" fill="#F57C00">
      âš ï¸ The Problem:
    </text>
    <text x="980" y="810" font-size="10" fill="#333">
      â€¢ Deep layers: saturated â†’ can't learn
    </text>
    <text x="980" y="825" font-size="10" fill="#333">
      â€¢ Shallow layers: exploding â†’ unstable
    </text>
    <text x="980" y="845" font-size="10" fill="#333">
      â€¢ "Asymmetric" - some dead, some crazy
    </text>
    <text x="980" y="860" font-size="10" fill="#333">
      â€¢ Training will fail!
    </text>

    <rect x="970" y="880" width="380" height="100" fill="#E1F5FE" rx="3"/>
    <text x="1160" y="905" font-size="11" font-weight="bold" text-anchor="middle" fill="#0277BD">
      ğŸ” What You See in Histogram:
    </text>
    <text x="980" y="930" font-size="10" fill="#333">
      Deep layers: sharp spikes at 0 (dead)
    </text>
    <text x="980" y="945" font-size="10" fill="#333">
      Shallow layers: very wide, flat (exploding)
    </text>
    <text x="980" y="960" font-size="10" fill="#333">
      Weird asymmetry - totally broken!
    </text>
  </g>

  <!-- Bottom key -->
  <rect x="50" y="1030" width="1330" height="50" fill="#E3F2FD" stroke="#1976D2" stroke-width="2" rx="5"/>
  <text x="715" y="1058" font-size="14" font-weight="bold" text-anchor="middle" fill="#1565C0">
    ğŸ”‘ Key Insight: "Signal" = gradient magnitude | "Learning" = weight update = lr Ã— gradient
  </text>
  <text x="715" y="1073" font-size="12" text-anchor="middle" fill="#0277BD">
    gain = 5/3 keeps all layers' gradients similar â†’ all layers learn at the same rate â†’ stable training!
  </text>
</svg>
